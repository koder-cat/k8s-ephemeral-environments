# ResourceQuota for PR environments
# Limits per namespace as defined in PRD (RNF-13)
# Variables to substitute: PROJECT_ID, PR_NUMBER
apiVersion: v1
kind: ResourceQuota
metadata:
  name: pr-quota
  namespace: ${PROJECT_ID}-pr-${PR_NUMBER}
  labels:
    app.kubernetes.io/managed-by: github-actions
    k8s-ee/type: ephemeral
    k8s-ee/project-id: "${PROJECT_ID}"
    k8s-ee/pr-number: "${PR_NUMBER}"
spec:
  hard:
    # Compute resources
    requests.cpu: "500m"
    requests.memory: 1Gi
    limits.cpu: "1"
    limits.memory: 2Gi
    # Storage
    requests.storage: 5Gi
    persistentvolumeclaims: "3"
    # Object counts
    pods: "10"
    services: "5"
    configmaps: "10"
    # Increased to accommodate Helm release secrets (1 per revision)
    secrets: "20"
    replicationcontrollers: "5"
