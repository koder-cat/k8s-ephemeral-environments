apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "k8s-ee-app.fullname" . }}-config
  labels:
    {{- include "k8s-ee-app.labels" . | nindent 4 }}
data:
  # Application port
  PORT: {{ .Values.app.port | quote }}
  # PR environment metadata
  {{- if .Values.prNumber }}
  PR_NUMBER: {{ .Values.prNumber | quote }}
  {{- end }}
  {{- if .Values.commitSha }}
  COMMIT_SHA: {{ .Values.commitSha | quote }}
  {{- end }}
  {{- if .Values.branchName }}
  BRANCH_NAME: {{ .Values.branchName | quote }}
  {{- end }}
  APP_VERSION: {{ .Values.image.tag | default .Chart.AppVersion | quote }}
  PREVIEW_URL: "https://{{ include "k8s-ee-app.hostname" . }}"
  # User-defined environment variables
  {{- range $key, $value := .Values.env }}
  {{ $key }}: {{ $value | quote }}
  {{- end }}
